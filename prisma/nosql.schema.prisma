// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// in order for schema changes to take effect use
// npm run db:migrate

// we're using nestjs-dto generator
// which also created swagger docs
// more options here: https://www.npmjs.com/package/@brakebein/prisma-generator-nestjs-dto

datasource db {
  provider = "mongodb"
  url      = env("MONGODB_URL")
}

// turns out we need both generators
generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/@prisma-mongo/prisma/client"
}

generator nestjsDto {
  provider                        = "prisma-generator-nestjs-dto"
  output                          = "../src"
  outputToNestJsResourceStructure = "true"
  classValidation                 = "true"
  prettier                        = "true"
  fileNamingStyle                 = "kebab"
}

enum OrderStatus {
  NOT_APPROVED
  APPROVED
  IN_PROGRESS
  DELIVERY
  COMPLETED
  CLIENT_CANCELLED
  EMPLOYEE_CANCELLED
}

type AddressType {
  street      String
  houseNumber Int
  apartment   Int?
  city        String
  country     String
}

type MenuItemType {
  itemId      Int
  name        String
  photoUrl    String
  description String
  ingredients String
  quantity    Int
  price       Float
}

model Order {
  /// @DtoReadOnly
  id           String         @id @default(auto()) @map("_id") @db.ObjectId
  /// @DtoReadOnly
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt()
  status       OrderStatus    @default(NOT_APPROVED)
  /// @IsEmail
  userEmail    String
  address      AddressType?
  restaurantId Int
  orderedItems MenuItemType[]
  /// @IsPositive
  totalPrice   Float
  /// @IsCurrency
  currency     String         @default("PLN")
}

model JobApplication {
  id              String  @id @default(auto()) @map("_id") @db.ObjectId
  firstName       String
  lastName        String
  age             Int
  email           String  @unique
  aboutMe         String?
  resumee         String? // to jest plik pdf
  jobTitle        String
  /// @IsPositive
  prefferedSalary Float
}
